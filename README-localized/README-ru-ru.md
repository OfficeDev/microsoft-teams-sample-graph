---
page_type: sample
products:
- office-teams
- ms-graph
languages:
- csharp
extensions:
  contentType: samples
  technologies:
  - Microsoft Graph 
  services:
  - Microsoft Teams
  createdDate: 5/30/2017 6:00:04 PM
---
# Примеры команд Microsoft Teams Graph

В этом примере приведены примеры вызовов многих API-интерфейсов Teams Graph, в том числе:

* Получить мои команды
* Получить каналы
* Получить приложения
* Создание канала
* Публикация сообщения
* Создать команду и группу
* Добавить команду в группу
* Добавить участника в команду
* Обновить настройки команды

## Родственные образцы

* [Образец Contoso Airlines для Microsoft Teams](https://github.com/microsoftgraph/contoso-airlines-teams-sample)
* [Версия узла. примеры API Microsoft Teams Graph](https://github.com/OfficeDev/microsoft-teams-sample-graph/tree/master/Node/SampleApp)

> Для получения дополнительной информации о разработке приложений для Microsoft Teams, пожалуйста, просмотрите [документацию для разработчиков](https://msdn.microsoft.com/en-us/microsoft-teams/index) Microsoft Teams.\**

## Предварительные требования

### Учетная запись O365 с правами администратора

Чтобы настроить это приложение, вам нужно быть глобальным администратором, поскольку только глобальные администраторы могут разрешать приложениям использовать разрешения, такие как Group.ReadWrite.All. Попробуйте создать собственного тестового арендатора, создав учетную запись разработчика с помощью нашей [программы для разработчиков Office 365](https://dev.office.com/devprogram).  

### Зарегистрированное приложение

Вам необходимо зарегистрировать приложение с помощью следующего процесса:

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/?linkid=2083908) с помощью личной учетной записи Майкрософт либо рабочей или учебной учетной записи.
2. Если ваша учетная запись предоставляет доступ к нескольким клиентам, в правом верхнем углу щелкните свою учетную запись и выберите для текущего сеанса работы нужный клиент Azure AD.
3. Выберите **Новая регистрация**.
4. Когда появится страница «Зарегистрировать приложение», введите регистрационную информацию вашего приложения:
   * **Имя** \- введите значимое имя приложения, которое будет отображаться пользователям приложения.
   * **Поддерживаемые типы учетных записей** — выберите учетные записи, которые должны поддерживать приложение.
   * **URI перенаправления (необязательно)** Выберите **Веб** и введите «http: // localhost: 55065 /» для **URI перенаправления**.
5. По завершении нажмите кнопку **зарегистрировать**.
6. Azure AD назначает уникальный идентификатор приложения (клиента) вашему приложению, и вы попадаете на страницу обзора вашего приложения. Чтобы добавить дополнительные возможности в свое приложение, вы можете выбрать другие параметры конфигурации, включая фирменную символику, сертификаты и секреты, разрешения API и прочее. 

   Скопируйте идентификатор приложения. Это уникальный идентификатор приложения.
7. В разделе **Управление** на левой панели выберите **Сертификаты и секреты**. В разделе **Секреты клиента** выберите **Новый секрет клиента**. Введите описание и срок действия, а затем нажмите кнопку **добавить**. Это создает секретную строку или пароль приложения, которые приложение использует для подтверждения своей идентичности.  

   Скопируйте значение из нового секрета.
8. В разделе **Управление** на левой панели выберите **проверка подлинности**. В разделе **неявное предоставление**проверьте, **маркеры доступа** и **Маркеры идентификаторов**. Благодаря этому при проверке подлинности приложение может получить данные для входа (id\_token) и артефакты (в данном случае — код авторизации), которые используются для получения маркера доступа. Сохраните изменения.
9. В разделе **управление**ми в области слева выберите пункт **разрешения API** а затем **добавить новое разрешение**. Выберите **Microsoft Graph** а затем **делегированные разрешения**. Добавьте разрешения «Group.ReadWrite.All» (чтение и запись всех групп) и «User.ReadWrite.All» (полный профиль чтения и записи всех пользователей). Щелкните **Добавление нового разрешения** еще раз, а затем **разрешения для приложения**. Добавьте разрешения «Group.ReadWrite.All» (чтение и запись всех групп) и «User.ReadWrite.All» (полный профиль чтения и записи всех пользователей).

Смотрите отдельные проекты readmes для получения дополнительной информации.
    
### Создайте и запустите образец приложения

1. Откройте пример решения в Visual Studio.
2. Получить идентификатор приложения и секрет приложения из предыдущего раздела
3. Создайте файл с именем Web.config.secrets (поместите его рядом с Web.config) и добавьте в свой appid и секрет приложения:

```
<?xml version="1.0" encoding="utf-8"?>
  <appSettings >
    <add key="ida:AppId" value="xxxxx"/>
    <add key="ida:AppSecret" value="xxxxx"/>
  </appSettings>
```

4. Обновите «Веб-сервер» вашего веб-приложения с помощью «ida: RedirectUri» вашего зарегистрированного приложения. 

* В обозревателе решений щелкните правой кнопкой мыши имя проекта веб-приложения, для которого вы хотите указать веб-сервер, и выберите «Свойства».
* В окне «Свойства» перейдите на вкладку «Интернет».
* В разделе «Серверы» обновите «URL проекта» с помощью «ida: RedirectUri» вашего зарегистрированного приложения.
* Нажмите «Создать виртуальный каталог»
* Сохраните файл.

5. Выполните сборку и запуск приложения.

6. Войдите в свою учетную запись и предоставьте запрошенные разрешения.

* Обратите внимание, что для запуска приложения вам понадобятся соответствующие повышенные права (Group.ReadWrite.All и User.ReadWrite.All).

7. Выберите операцию, например «Получить мои команды», «Получить каналы», «Создать канал» или «Опубликовать сообщение».

8. Сведения об ответе отображаются в нижней части страницы.

## Отзывы

Мы приветствуем ваши отзывы! [Вот как отправить нам свое.](https://msdn.microsoft.com/en-us/microsoft-teams/feedback).

## Правила поведения Майкрософт, касающиеся обращения с открытым кодом

Этот проект соответствует [Правилам поведения разработчиков открытого кода Майкрософт](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [вопросов и ответов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## Участие

Пожалуйста, ознакомьтесь с разделом [Участие](contributing.md) для получения подробной информации о процессе отправки запросов на получение данных нам.

## Лицензия

Этот проект лицензируется по лицензии MIT - подробности см. В файле [Лицензия](LICENSE).

## Авторские права

© Корпорация Майкрософт (Microsoft Corporation), 2018. Все права защищены.
